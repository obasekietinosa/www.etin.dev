---
import Button from "../components/Button.astro";
import ProjectPreview from "../components/ProjectPreview.astro";
import RolePreview from "../components/RolePreview/RolePreview.astro";
import RolePreviewLayout from "../components/RolePreview/RolePreviewLayout.astro";
import NotePreviewList from "../components/NotePreview/NotePreviewList.astro";
import NotePreview from "../components/NotePreview/NotePreview.astro";
import { getRoles } from "../domains/Roles";
import { getProjects } from "../domains/Projects";
import { getNotes } from "../domains/Notes";
import Layout from "../layouts/Layout.astro";

const [roles, projects, notes] = await Promise.all([
  getRoles(),
  getProjects(),
  getNotes(),
]);

const displayedRoles = roles.slice(0, 2);
const remainingRoleCount = Math.max(roles.length - displayedRoles.length, 0);
---

<Layout>
  <header class="mb-24 md:mb-32">
    <div class="relative">
      <h1 class="text-7xl md:text-8xl lg:text-9xl font-bold tracking-tighter leading-none mb-8">
        <span class="block">Etin</span>
        <span class="block text-accent">Obaseki.</span>
      </h1>
      <h2 class="text-2xl md:text-3xl font-light tracking-tight text-muted-foreground max-w-2xl">
        Software Engineer. <span class="text-foreground">Building digital products with purpose and precision.</span>
      </h2>
    </div>
    <div class="w-full h-px bg-border mt-16"></div>
  </header>

  <main class="space-y-32">
    <!-- Experience Section -->
    <section>
      <div class="flex flex-col md:flex-row justify-between items-baseline mb-12">
        <h2 class="text-4xl md:text-5xl font-bold tracking-tight">Experience</h2>
        <span class="hidden md:block text-muted-foreground font-mono text-sm tracking-wider uppercase">Career Highlights</span>
      </div>

      <p class="text-xl md:text-2xl font-light text-muted-foreground max-w-3xl mb-16 leading-relaxed">
        I currently work in health-tech as a software engineer. A few of my most
        recent roles have been in health-tech or orthogonal to it, so you can
        say I’m becoming something of a specialist.
      </p>

      <RolePreviewLayout remainingCount={remainingRoleCount}>
        {displayedRoles.map((role) => <RolePreview role={role} />)}
      </RolePreviewLayout>
    </section>

    <!-- Projects Section -->
    <section>
      <div class="flex flex-col md:flex-row justify-between items-baseline mb-12 border-b border-border pb-4">
        <h2 class="text-4xl md:text-5xl font-bold tracking-tight">Selected Work</h2>
        <Button variant="ghost" href="/projects" class="hidden md:inline-flex">View all projects</Button>
      </div>

      <p class="text-xl md:text-2xl font-light text-muted-foreground max-w-3xl mb-16 leading-relaxed">
        I aspire to regularly do cool things and talk about them here. If this
        section isn’t getting regularly updated, it signifies some sort of
        personal failing on my part which must be rectified.
      </p>

      <div class="space-y-12">
        {projects.map((project) => <ProjectPreview project={project} />)}
      </div>

      <div class="mt-12 md:hidden">
        <Button variant="secondary" href="/projects" class="w-full">See all projects</Button>
      </div>
    </section>

    <!-- Writing Section -->
    <section>
      <div class="flex flex-col md:flex-row justify-between items-baseline mb-12 border-b border-border pb-4">
        <h2 class="text-4xl md:text-5xl font-bold tracking-tight">Writing</h2>
        <Button variant="ghost" href="/notes" class="hidden md:inline-flex">View all notes</Button>
      </div>

      <p class="text-xl md:text-2xl font-light text-muted-foreground max-w-3xl mb-16 leading-relaxed">
        I like to write. This section contains thoughts from different spheres of my life.
        Any opinions expressed are solely mine.
      </p>

      <NotePreviewList class="space-y-0">
        {notes.map((note) => <NotePreview note={note} />)}
      </NotePreviewList>

      <div class="mt-12 md:hidden">
         <Button variant="secondary" href="/notes" class="w-full"> See all writing </Button>
      </div>
    </section>
  </main>

  <footer class="mt-32 pt-16 border-t border-border">
    <div class="grid md:grid-cols-2 gap-12">
       <div>
         <h3 class="text-2xl font-bold mb-4">Etin Obaseki</h3>
         <p class="text-muted-foreground">Software Engineer based in the cloud.</p>
       </div>
       <div class="flex justify-start md:justify-end gap-8">
          <a href="https://github.com/etin" class="text-muted-foreground hover:text-accent transition-colors font-mono uppercase text-sm tracking-wider">Github</a>
          <a href="https://twitter.com/etin" class="text-muted-foreground hover:text-accent transition-colors font-mono uppercase text-sm tracking-wider">Twitter</a>
          <a href="mailto:hello@etin.dev" class="text-muted-foreground hover:text-accent transition-colors font-mono uppercase text-sm tracking-wider">Email</a>
       </div>
    </div>
    <div class="mt-16 text-xs text-muted-foreground font-mono">
      &copy; {new Date().getFullYear()} Etin Obaseki. Designed with Bold.
    </div>
  </footer>
</Layout>
